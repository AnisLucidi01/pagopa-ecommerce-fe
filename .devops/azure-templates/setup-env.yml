# Azure DevOps pipeline template used to build bundle.
parameters:
  - name: 'env'
    type: string
    default: ''

  - name: 'api_timeout'
    type: number
    default: 10000

  - name: 'api_host'
    type: string
    default: ''

  - name: 'api_base_path'
    type: string
    default: ''

  - name: 'npg_sdk_url'
    type: string
    default: ''
  
  - name: 'gdi_check_timeout'
    type: number
    default: 12000

  - name: 'webview_pm'
    type: string
    default: ''

  - name: 'transaction_basepath'
    type: string
    default: '/ecommerce/io/v1/transactions'

steps:
- bash: |
    chmod +x env.sh
    env -i \
      ECOMMERCE_ENV=${{ parameters.env }} \
      ECOMMERCE_API_TIMEOUT=${{ parameters.api_timeout }} \
      ECOMMERCE_API_BASE_HOST=${{ parameters.api_host }} \
      ECOMMERCE_API_BASE_PATH=${{ parameters.api_base_path }} \
      ECOMMERCE_GDI_CHECK_TIMEOUT=${{ parameters.gdi_check_timeout }} \
      ECOMMERCE_NPG_SDK_URL=${{ parameters.npg_sdk_url }} \
      ECOMMERCE_CONFIG_WEBVIEW_PM_HOST=${{ parameters.webview_pm }} \
      ECOMMERCE_TRANSACTION_BASEPATH=${{ parameters.transaction_basepath }} \
      bash env.sh

  displayName: 'Populate environment file'
